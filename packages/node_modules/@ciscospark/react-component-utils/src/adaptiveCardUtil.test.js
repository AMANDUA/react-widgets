import {hasAdaptiveCard} from './adaptiveCardUtil';

describe('Adaptive Card Util functions', () => {
  const activity = {
    object: {
      displayName: 'Hello World!',
      displayNameHTML: {
        __html: 'Hello World!'
      },
      cards: [
        '{"type":"AdaptiveCard","version":"1.0","body":[{"type":"TextBlock","text":"Adaptive Cards","separation":"none"}]}'
      ],
      objectType: 'comment'
    },
    verb: 'post'
  };
  const activity1 = {
    object: {
      displayName: 'Hello World!',
      displayNameHTML: {
        __html: 'Hello World!'
      },
      cards: [
      ],
      objectType: 'comment'
    },
    verb: 'post'
  };
  const sparkInstance = {};

  it('It should return true when message contains adaptive card', () => {
    expect(hasAdaptiveCard(activity.object.cards, sparkInstance)).toEqual(true);
  });

  it('It should return false when message does not contains adaptive card', () => {
    expect(hasAdaptiveCard(activity1.object.cards, sparkInstance)).toEqual(false);
  });
});
