const urlTypes = ['url', 'backgroundImage', 'iconUrl'];

/**
 * replaces the index with the uri in cards
 * @param {Object} cardsActivity
 * @param {Array} decryptedURLs
 * @returns {Object}
 */
export function replaceIndexWithBlobURL(cardsActivity, decryptedURLs) {
  const activityObject = cardsActivity;

  if (activityObject) {
    Object.keys(activityObject).forEach((property) => {
      if (Object.prototype.hasOwnProperty.call(activityObject, property)) {
        const index = urlTypes.indexOf(property);
        const key = urlTypes[index];

        if (index !== -1 && property === key && !Number.isNaN(Number(activityObject[key]))) {
          activityObject[key] = decryptedURLs[Number(activityObject[key])];
        }
        else if (typeof activityObject[property] === 'object') {
          replaceIndexWithBlobURL(activityObject[property], decryptedURLs);
        }
      }
    });
  }

  return activityObject;
}

export default replaceIndexWithBlobURL;
